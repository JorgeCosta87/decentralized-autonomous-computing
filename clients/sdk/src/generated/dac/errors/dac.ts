/**
 * This code was AUTOGENERATED using the Codama library.
 * Please DO NOT EDIT THIS FILE, instead use visitors
 * to add features, then rerun Codama to update it.
 *
 * @see https://github.com/codama-idl/codama
 */

import {
  isProgramError,
  type Address,
  type SOLANA_ERROR__INSTRUCTION_ERROR__CUSTOM,
  type SolanaError,
} from "@solana/kit";
import { DAC_PROGRAM_ADDRESS } from "../programs";

/** MissingAccount: Missing account */
export const DAC_ERROR__MISSING_ACCOUNT = 0x1770; // 6000
/** NeedAtLeastOneCodeMeasurement: Need at least one code measurement */
export const DAC_ERROR__NEED_AT_LEAST_ONE_CODE_MEASUREMENT = 0x1771; // 6001
/** TooManyCodeMeasurements: At most 10 code measurements are allowed */
export const DAC_ERROR__TOO_MANY_CODE_MEASUREMENTS = 0x1772; // 6002
/** InvalidPDAAccount: Invalid PDA account */
export const DAC_ERROR__INVALID_P_D_A_ACCOUNT = 0x1773; // 6003
/** AccountAlreadyInitialized: Account already initialized */
export const DAC_ERROR__ACCOUNT_ALREADY_INITIALIZED = 0x1774; // 6004

export type DacError =
  | typeof DAC_ERROR__ACCOUNT_ALREADY_INITIALIZED
  | typeof DAC_ERROR__INVALID_P_D_A_ACCOUNT
  | typeof DAC_ERROR__MISSING_ACCOUNT
  | typeof DAC_ERROR__NEED_AT_LEAST_ONE_CODE_MEASUREMENT
  | typeof DAC_ERROR__TOO_MANY_CODE_MEASUREMENTS;

let dacErrorMessages: Record<DacError, string> | undefined;
if (process.env.NODE_ENV !== "production") {
  dacErrorMessages = {
    [DAC_ERROR__ACCOUNT_ALREADY_INITIALIZED]: `Account already initialized`,
    [DAC_ERROR__INVALID_P_D_A_ACCOUNT]: `Invalid PDA account`,
    [DAC_ERROR__MISSING_ACCOUNT]: `Missing account`,
    [DAC_ERROR__NEED_AT_LEAST_ONE_CODE_MEASUREMENT]: `Need at least one code measurement`,
    [DAC_ERROR__TOO_MANY_CODE_MEASUREMENTS]: `At most 10 code measurements are allowed`,
  };
}

export function getDacErrorMessage(code: DacError): string {
  if (process.env.NODE_ENV !== "production") {
    return (dacErrorMessages as Record<DacError, string>)[code];
  }

  return "Error message not available in production bundles.";
}

export function isDacError<TProgramErrorCode extends DacError>(
  error: unknown,
  transactionMessage: {
    instructions: Record<number, { programAddress: Address }>;
  },
  code?: TProgramErrorCode,
): error is SolanaError<typeof SOLANA_ERROR__INSTRUCTION_ERROR__CUSTOM> &
  Readonly<{ context: Readonly<{ code: TProgramErrorCode }> }> {
  return isProgramError<TProgramErrorCode>(
    error,
    transactionMessage,
    DAC_PROGRAM_ADDRESS,
    code,
  );
}
